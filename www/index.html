<!DOCTYPE HTML>
<html>
	<head>
		<title>nativeDroid II - jQueryMobile Template</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

		<link rel="stylesheet" type="text/css" href="css/index.css" />
	    <!-- <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" /> -->
		<!-- <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jquerymobile/1.4.5/jquery.mobile.min.css" /> -->
		<link rel="stylesheet" href="custom/css/font-awesome.min.css" />
		<link rel="stylesheet" href="custom/css/jquery.mobile.min.css" />
		<link rel="stylesheet" href="vendor/waves/waves.min.css" />
		<link rel="stylesheet" href="vendor/wow/animate.css" />
		<link rel="stylesheet" href="css/nativedroid2.css" />
		<style>
		ytp-watermark 		{display: none !important;}
		yt-uix-sessionlink  {display: none !important;}
		</style>
		
		
		<meta name="mobile-web-app-capable" content="yes">
	 	<meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
 
	</head>
	<body onload="onLoad()">

		<div data-role="page">

			<nd2-include data-src="examples/fragments/panel.left.html"></nd2-include>

			<div data-role="panel" id="bottomsheet" data-animate="false" data-position='bottom' data-display="overlay">
				<nd2-include data-src="examples/fragments/bottom.sheet.html"></nd2-include>
			</div>

			<div data-role="header" data-position="fixed" class="wow fadeInDown" data-wow-delay="0.2s">
				<a href="#bottomsheet" class="ui-btn ui-btn-right wow fadeIn" data-wow-delay='1.2s'><i class="zmdi zmdi-more-vert"></i></a>
				<a href="#leftpanel" class="ui-btn ui-btn-left wow fadeIn" data-wow-delay='0.8s'><i class="zmdi zmdi-menu"></i></a>
				<h1 class="wow fadeIn" data-wow-delay='0.4s'>KTube</h1>
			</div>
			<!-- 
				<div data-position="fixed"  class="wow">
					<iframe id="videoframe" width="100%" height="300" src="http://www.youtube.com/embed/8dOVI2mOI4k?rel=0&amp;controls=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe>
				</div>-->
			<div id="player"></div>
				
			<div role="main" class="ui-content" data-inset="false">
				<ul data-role="listview" data-icon="false" id="videolist">
					<li data-role="list-divider">
						Video
					</li>
					<li>
						<a href="#" onclick="changevideo('xZk25hL57oU');">
							<img src="" class="ui-thumbnail ui-thumbnail" />
							<h2>Bob il treno</h2>
							<p>Educativo - ITA</p>
						</a>
					</li>		
					
				</ul>

				<hr />
				<div id="lista"></div>
				<div id="nome"></div>
				<div id="deviceready" class="blink">
					<p class="event listening">Connecting to Device</p>
					<p class="event received">Device is Ready</p>
				</div>
			</div>

		</div>

		<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> -->
		<!-- <script src="//code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script> -->
		<!-- <script src="//ajax.googleapis.com/ajax/libs/jquerymobile/1.4.5/jquery.mobile.min.js"></script> -->
		<script src="custom/js/jquery.min.js"></script>
		<script src="custom/js/jquery-ui.min.js"></script>
		<script src="custom/js/jquery.mobile.min.js"></script>		
		<script src="vendor/waves/waves.min.js"></script>
		<script src="vendor/wow/wow.min.js"></script>
		<script src="js/nativedroid2.js"></script>
		<script src="nd2settings.js"></script>
		
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>		
		<script type="text/javascript">
			app.initialize();
			
			function changevideo(videoid) {
				document.getElementById("player").src = "http://www.youtube.com/embed/"+videoid+"?rel=0&controls=1&showinfo=0&modestbranding=1";
				//"http://www.youtube.com/embed/"+videoid+"?rel=0&amp;controls=0&amp;showinfo=0";
			}
			
			function onLoad() {
				document.addEventListener("deviceready", onDeviceReady, false);
				document.addEventListener("backbutton", onBackKeyDown, false);
			}	
			
			function onDeviceReady() {
				alert(window.screen.width+' - '+window.screen.height+' - '+(window.screen.width/16)*9);
				document.getElementById("nome").innerHTML = "Ciao " + localStorage.utente;	
			}				
			function onBackKeyDown(e) {
				e.preventDefault();
				alert('Back non consentito.');
			}			
			
			//if (typeof(Storage) != "undefined") { localStorage.utente = "Giulia"; }
			
			


		</script>	
		<script>
      // 2. This code loads the IFrame Player API code asynchronously.
      var tag = document.createElement('script');

      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      // 3. This function creates an <iframe> (and YouTube player)
      //    after the API code downloads.
      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height:  (window.screen.height/16)*9,
          width: '100%',
          videoId: '8dOVI2mOI4k',
		  playerVars: { 'showinfo' : 0,'iv_load_policy': 3, 'controls': 1, 'rel':0, 'modestbranding':1 },
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
      }

      // 4. The API will call this function when the video player is ready.
      function onPlayerReady(event) {
        event.target.playVideo();
		event.target.setVolume(50);
		$( ".ytp-watermark" ).removeClass( "ytp-watermark yt-uix-sessionlink" );
      }

      // 5. The API calls this function when the player's state changes.
      //    The function indicates that when playing a video (state=1),
      //    the player should play for six seconds and then stop.
      var done = false;
      function onPlayerStateChange(event) {
        if (event.data == YT.PlayerState.PLAYING && !done) {
          setTimeout(stopVideo, 6000);
          done = true;
        }
      }
      function stopVideo() {
        player.stopVideo();
      }
    </script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="https://apis.google.com/js/client.js?onload=onGoogleLoad"></script>
		<script>
			function onGoogleLoad() {				
				gapi.client.setApiKey(localStorage.GTApiKey);
				gapi.client.load('youtube', 'v3', function() {

					var request = gapi.client.youtube.playlistItems.list({
						part: 'snippet',
						playlistId: 'PLWWCF1LDEhZNuVoNLwei6oxv6aE6MPBZV',
						maxResults: 50
					});

					request.execute(function(response) {
						for (var i = 0; i < response.items.length; i++) {						
							console.log("Title " + response.items[i].snippet.title + " published at " + response.items[i].snippet.publishedAt);
							console.log(response.items[i].snippet.thumbnails.default.url);
							console.log("ID " + response.items[i].snippet.resourceId.videoId);
							var video=response.items[i].snippet.resourceId.videoId;
							var urltmb=response.items[i].snippet.thumbnails.default.url;
							$("#videolist").append('<li class="ui-li-has-thumb"><a href="#" class="ui-btn waves-effect waves-button waves-effect waves-button" onclick="changevideo(\''+video+'\');"><img src=\' '+urltmb+' \' class="ui-thumbnail ui-thumbnail" /><h2>'+response.items[i].snippet.title+'</h2></a></li>');
						}
					});
				});
			}
			
			
		</script>

			
	
	</body>
</html>
